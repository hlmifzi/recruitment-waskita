"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports["default"] = streamRenderer;

var _server = require("react-dom/server");

function streamRenderer(req, res, reactEl, htmlData, options) {
  var stream = (0, _server.renderToNodeStream)(reactEl);
  var segments = htmlData.split("<div id=\"root\">");
  res.write(segments[0] + "<div id=\"root\">");
  stream.pipe(res, {
    end: false
  });
  stream.on('end', function () {
    if (options.onEndReplace) {
      segments[1] = options.onEndReplace(segments[1]);
    }

    res.write(segments[1]);
    res.end();
  });
}